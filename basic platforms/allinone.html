<!DOCTYPE html>
<html><head><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<script>


function displayStringLoop(e,t,a,n,i,s){let r=Math.floor(frame/6%e.length);displayImage(e[r].a,e[r].c,t,a,n,i,s)}function displayImage(e,t,a,n,i,s,r){ctx=canvas.context;for(let o=0;o<e.length;o++)if(0!=t[e[o]]){if(o>trace)return void(trace=o);ctx.beginPath(),ctx.fillStyle=t[e[o]];let c=0;-1===r&&(c=i*s),ctx.fillRect(a+c+r*(o%i)*s,n+Math.floor(o/i)*s,r*(s+.5),s+.5),ctx.closePath()}}let c=["#000000","#ffd738","#d1ff3a","#327fa8","#6d92a6","#c37dc9","#c3f7f7","#9397bd","#c3dbf7","#dbc3f7","#fffb80","#1F29C1","#FF6638","#EAFF30","#FFFFFF","#EA1F1C","#8E423A","#FF6232","#8E7F7D","#D36A55","#f7d92a","#FFAB3D","#FF923F","#303030","#03a822","#9aed66","#FFD907"],sunLoop=[{s:"+2,5)8(8(8(8(8)6)"},{s:"+2+6)8)7(5(3(8)8(7("},{s:"*4*;6(7(9(8)7)4*"}],sunCol=[!1,c[26]],walkLoop=[{s:"11111111121/6<G1)3)3BF03=2<2DF/PE@G-SGE=G,PZQG=FE=+FRGdGBF>F*SHdG2?H?F)RIeF2@G@F*IfF2@FB-gF2?FC+FhF2?FC*FhH2>FC)Fh(H2=F@F<F)GeG+F2=Fe@F)H.F2=Fe?F*G.eF2=FA*H-f2=F)>F+G-e(F2=*I1H)I*H1H*H+G)",c:[!1,c[15],c[17],c[16],c[18],c[0],c[19]]},{s:"11111111.311(3=2G1.2BF1)5DG.P4E?F,ZRGE?F+PdQGnDF?F*FRGnFAH?F)SHnG@G@F)RHpF2?FBF*JoF2?GAF-FoG2@FAF-pG2@FB,FoF(G2?Fo?F,FoF)F2>Go?F,Fo*F2>FoF>F,Fo+F2=FoG>F,Fo,F2<oF(F=F,Gn-F2<oF(F=F,H-HnF)=F-H,InF)G1,HnF)H,",c:[!1,c[15],c[17],c[16],c[18],c[0],c[19]]},{s:"11111111111(61/3@F1+4CG0P3E>G-RGE?,PZQGE?F+FRGdE>F*SHdE?F)RHe2BF@F+HeF2AG@F-FeF2@GBF,FeF2?GeAF,f2?GfF@F+FeF2>GfG?F,FeF2>GfF?F-fF2=)f(F>F-FeG=*FeF?-HdF2=*FeF>.G)F=F*GdG<0G(I+J1)H,Id.",c:[!1,c[15],c[17],c[16],c[18],c[0],c[19]]},{s:"11111111.4113>2F1.2BF1)3(2DG/3=2E=F-PEFBF+SFEAF*PZQGCFAF*FRGCFAG(SJBFAF(RKAFe@F*I(G@Ff@F/F@FfAF.F@GeAG-F?K@G-F?G)G@G-G>Fd*F@dF.F=Ge)F>Hd.G<F(f)F<HeF.H)Fe(I(FeG.G)H(H*I1)H1+",c:[!1,c[15],c[17],c[16],c[18],c[0],c[19]]},{s:"11111111111(7<1-3L=1*2OF<.3F(2OH<,PON+S=H<OF<*PZQ>F<2OF<*<Q?d<2OG)S@2OH<(RA2L<J<*?d<2K=K<.=2I=L=.<2I=d<L<-<2H>d=L<,<2H=(f=J<*>3F=e)e<I=*=H?d+d<I,=F=*=+d<G<1+>+=F<1+>*>d=1/>)=,",c:[!1,c[15],c[16],c[17],c[18],c[0],c[19]]},{s:"11111111-5103?21.2B3F1*3EF/4GE>-PECF+SG=FE<F+PZQG=F2E<F*FQH<F2E=F)SJ2E=G(RH(F2AFBF*H(G2@HAF-G2@GCF-F2>F<FgF@F,G2=IgAF,F2<I(g(AF,F2I)f)@F,Jd*eF)?F,If*Fe)?-HdG+Fe*>-G(G+Ge*F=F,G(G+H,H*",c:[!1,c[15],c[17],c[16],c[18],c[0],c[19]]}],jumpLoop=[{s:"-4112@51*F2E5F/GTCH-F<FU=G@G,F<FPZPZQ>2M+F<GPFQ@8F+F<FTE=2F*F<dSE?2F)F<eHE@2)FeF(F@FE2)FdF)e?dFDF(H*f?dI?F)H*Fe@gF=F+G*FeDF=F1eCFeF.H(FdAGeFd-FeGe@HeF.Fj@GdF<I)GjAG?dF(HeGfF<GBFdF)H*H)GA)G1,F?F)G1-I111("},{s:"111(4112@41+F2D31)GT@F4F.F<FUDF-F<FPZPZQEF,F<GPFQE=F+F<FTE>F*FeS?FDF*FfH@FCF)GeG(FAI?F)I*FDH=F*G+FE<F>*F,FdE<F=0FeDF<G/GgBH/GgGAH.FiG@H.FgJ@F/GeG,F@F.FeF/F@F-FdF1G>G,H1)K,G1-G)"},{s:"111)4112?2,3G/F2A*3F<3F.2FT=3F@2G+F<FUE3+2<FPZPZQE<2F)G<GPFQE>F)G<FTE>F(GfSBI>F(Ff(IAK>Gd*FCG=J<F,FBG?I=,FdE>F(H,FeE=F)G,Ff>FAF0GhGAF0FfH(F@F1FeG*F?F1FgF*F?F1FgF*F?1)FfF*F>F1*FeF+H1,H+H1-G+G1"}],jumpCol=[!1,c[15],c[17],c[16],c[18],c[0],c[19]],sleepCol=[!1,c[16],c[15],c[17],c[19],c[18],c[0]],stillCol=[!1,c[15],c[16],c[17],c[18],c[0],c[19]],sleepLoop=[{s:"111111111111111111.61/<2=H31,>L31*<OF21(=O40=OI2/=L<KP2-=M2F2PHP2-=H<K2PHP2,<J2PG2G2<HP2)G3F<G3<G2PF2<HP2(3[4H2<H2G2<GP2<_3H2<G2PG2PF2(<[2ZdZ3I2<G2G2<G2<_3F3G2<F2PF3FP2(F3Z4F4G3G3P2FP4SGQ2P3<PFP2S4M3PIP5P3("},{s:"1111111111111111)61/<2=H31,=M31*<OF21(<OF40=OI2/=OIP2-=M<KP2,>M2GPHP2+=H2F<H2G2PHP2+<J2QG2G2IP2)G3F<G3<H2F2<HP2(3[4H2<H2F2=G2(<_3H2<H2F3PF2(<[2ZdZ3I2<G2G2<G2<_3F3G2<G2F3FP2(F3Z4F5F3G3P2FP4SGQ2Q2<PFP2S4M3PIP5P3("},{s:"1111111111111.511>G31.<2K31+=N31(=OG21<OF2G2/=OI2.=OJP2,=N<KP2,<G3K2GPHP2+=H2P<J2QHP2+2J2QG4PIP2)F4F<G3<H2F2<HP2(3[4H2<H2P2=G2(<_3H2<H2F3PF2(<[2ZdZ3I2<G2PF2<G2<_3F3G2<GPF3FP2(F3Z4F8GP2P2FP2(2SGQ2R<PFP2S4M3PIP5P3("}],stillLoop=[{s:"11111111111*3=103I=13+2M<.3G4(2N<-POM<+S=OI<+PZQ=e<J<K<*<Q>fK<J<)S>e<2O=)R?f2J<I<,>)<e2J<J<0<e<2H<dJ</<f<2GgI</<e<2G<gI<.<e<2G<hJ<-f<2F<(g(I<-<e(<2F<(g)H<,=e(<2<)=e)H<,>)>*>)F=.=)?(?(?.=*>(>)>+"},{s:"11111111111*5=1/2J2<1,3L2</3*2O2<-2H3OH<+PON<*SOF<F<I<)PZQ=dL<F<dI<)<Q>e<L<dI<(S>f<K<dG<F<(R?g<2H<fG<+>)<f<2H<fH/<e=3G<gH.<f4G<f(dH<,<f<2H<g(dH<,<e<3F<(h)H,<f(<3*g(<H,<e<(=+<f(I<*=d*>*<e<(<G<+>+=)>d)=F<,=/?)?)"}],homeImg={s:"111111111*311(=4(31-=)61,=)3G21-<)71,=)3)41+</31+</=,?,DP<)>S=)=W=)=U?T<R<,=P>P=S>Q=-=R>Q>S</=R<P>T<1(?P<T?.?Q?P?Q=,=SBQ>P=+<Q?Q?S=P<*=Q<S=*>S<*<T>.A)C1111(",c:[!1,c[12],c[24],c[13],c[25]]},tigerJumpLoop=[{s:"1111111111111111111111111111111111)2<211(3<5<-F*F-2=3<2<3<,2<F<3*2<4<2<5<,G<G<3<3<3<4<2<2+FPGPF2<2<:<4<(2(PZGZP2<3<2<2P<2<4<4<(K5<2<P<P2<3<2P(2)F<d<G<3<2P<R<3<2P-R(<3<Q<P)<F<4P/F3<2P2+HP<3=,F2=2<P-<F=)4P<2F<4Q/<FP+=4F<3<1G=P*4(G31)I<F,",c:[!1,c[21],c[23],c[22],c[14],c[0],c[15]]},{s:"1111111111111111111111111111111-211*2=3/F*F.2<4<2<.2H2F+2<3<6<-K<3<3<3<2<2=,FPGPG=2=2<3<4<3)2(PZGZPF5<3<9=)L<5Q<2<5<(2*F<d<G<4P<Q<3=2P.R(F3<P<Q<QF<3<1<3=(Q<*=3Q.GP3P/GP=2Q<*<F<3<1=P(4<P(G4Q1G=P=3F<Q2=1)K<(G(3<1.H(",c:[!1,c[21],c[23],c[22],c[14],c[0],c[15]]},{s:"1111111111111111111111111111111+2<20F*F/@2/<H<.3<3<3-L2*>2=2>-FPGPG3=2@2=2<*<(PZGZP=2>2=2?2<)2<(K?2<2=2<2<2=2=)F2d2G?2?2<2<2>2+RF=2=2<P2P=2>2/FP<3<2Q2R2=P2P.2F2<2Q)2Q2(F=2P*<+F2<Q0F2>2P2<2)FP=P1(G=2<2<)2F2<31)3@)G2=P1*H2+H3=10",c:[!1,c[23],c[21],c[22],c[14],c[0],c[15]]}],tigerWalkLoop=[{s:"11111111111111111111111111111111111*2+20=F</<F2F2<.<G=F<.3F3=*<F?F<F=F+2P3P3<F<F=F<FC(F(2Z3ZP2<F?F=F<F<F<(F=(F6F=F<F?F<F<F2,2FdF2F3>F<FQF>F2P,R(3Q<F=FQFP<FP2Q.3SF<FQFQ<F(3F-3FP)F<P)FP(<FP)2P,2FP*=F-<Q)G+2Q+F<P-<G)2Q)2G,=FP,<Q(3F*3.?*>F(4)",c:[!1,c[22],c[21],c[23],c[14],c[0],c[15]]},{s:"11111111111111111111111111111111111*2*2/<G<F0F<2<G+F<G<G<F/3<3F<F<H<G<F<F<F,2P3P2F<G<G<G<I<F)F(PZ3ZPI<L<G(F+7F<K<H<F<(<)F(2<d<2<F<F<F<FP<PF<F<F)F<*R(3F<G<Q<P<H213P<G<Q<)PGP2<02=(<G-F=2<03P<G/G<P02=PG/2G<12PG/3G<F0H2.3=H*",c:[!1,c[22],c[23],c[21],c[14],c[0],c[15]]},{s:"1111111111111111111111111111111111*2<11*2<3<.F+F-<2<3<3<-2<G<2*2<5<3<2<2,G=G<2<3<2<2<3<4+GPGPG<2<2<2<5<3<+FPZGZP4<5<3<3<3*K2<3<2P<2<7(<2<)F<d<2<3<2P<Q<2<2=*2+RF4Q<Q<(2<2P1(F3=.<3<1(3<PG,G<3P02=FP=F+=P=2P<-3P*J*GP3<2P+2=,=G*F<G(4)",c:[!1,c[21],c[23],c[22],c[14],c[0],c[15]]},{s:"1111111111111111111111111111111.211*3<2<116<3-F*F,3=2<4<2<,2<F<2(<2(2<4<2<5<,G<G<2<4<6<2<4*GPGPF2<2<3<3<2<2<4*FPZGZP<4<2<Q<2<4<2*L2<3<R<P5<(2<*F<d<F<2<2<Q<)P=2<*3*R(<4<P<*<3P1)<2<P<-FP<2<1(3PF-F=4P02=P<-GP(=Q.3P(G-<F<)3P-3<)=F,H)=2*",c:[!1,c[21],c[23],c[22],c[14],c[0],c[15]]},{s:"11111111111111111111111111111111112<2<21/<3<5<2-F+F*2<3<3<4<2,2<G<2F<4<3<3<3<2,G=G3<3<4<4<3<+FPGPF<3<3<3<4<3<2*PZGZP2<2<3<2<4<3<3(2(K2<4<Q<P2<3<2(<2<(F<d<F=4R<P(<3P<P-R)2<2<P<P*3P=1(3<P.=Q1)=PF.2=P1(3Q</4<1>P0FP=2/F4F0F<(3+",c:[!1,c[21],c[23],c[22],c[14],c[0],c[15]]}],birdStillLoop=[{s:"+61,71*4<41*F71)H61(H90G*8.G+2Q3Q2-F+P6R21P2R2S20P6T2.Q3Q2U.Q7U,S2R4T+S9S*T(9Q*S+;*P.F90F(F)F61F*G,",c:[!1,c[11],c[14],c[12],c[13]]},{s:"11+61,71*<3F41*<71)>80?9/=*7Q-=+2Q3S,<+P6T0P2R2U/P7U2,Q3R3U,R8T+S3R3T*T(9Q2)T*;2)Q-;1<)<61=)<*2)",c:[!1,c[11],c[12],c[14],c[13]]},{s:"1111+61,71*4<41*F71)H8P/H9Q-H*7R,F,2Q3T16U/P2R3U-Q8U,R3Q4T+S9S+S4R4R*S*9P3*Q,;1F(2F2(31)F(G-",c:[!1,c[11],c[14],c[12],c[13]]}],birdFlapLoop=[{s:"11051,71*91)3<4<2.G+4P4(H)J2(3R2(I(HZH4R2HZJ[G5Q2G[K[F5Q2F[L([5Q2[(H(H)Z6P2Z)H(H*6P2*H(H*8*G*G*7+G*F+7+F/5P21+Q)P1+Q*P1*Q*P1",c:[!1,c[11],c[14],c[13],c[12],c[20]]},{s:"1111051,71=(3F6.?)6F2(=*A(4P4?(B4Q3(E[4R(E<[5Q>ZA]5Q>ZA)[6P=([?*[6P<*Z?+8<+Z.81*2P51,P51,P)P1,P*P1+Q*P0",c:[!1,c[11],c[13],c[14],c[12],c[20]]},{s:"11111106*=)=,8(D*2F4F2E<)4P4@ZA(4P3@[?[4Q3?]?5R=[<[([>5R=[(Z*[>5Q<[.[=5Q<Z1(7P<1*71+61,P51+Q*P1+P+P1,P)Q/",c:[!1,c[11],c[13],c[14],c[12],c[20]]}],groundImg={s:"(2(2(6=3<",c:[!1,c[1],c[2]]},babyCol=[!1,c[1],c[0]],babyWalkLoop=[{s:".41(603<2<303<31(4/:,;3)3)7)3(2+6*2-6)2-604(3/4)3.3,31*3+"},{s:"-41)513<2<204<315(2.:,9(3*3(7)3)2)7*2(2+51(513(313)3/3*3/2,2+"},{s:"-41(613<2<204<3150;+9(4*2(7*2*2(7-2*5.2*51(2(313)303*3/2-2)"},{s:"-41(613<2<204<315)3,:(2*9.9.2(7.2)502(51(2)312*4.3,3-3/"}],babyCarriedLoop=[{s:"11111)41(603<2<303<31(4/2(8(2*3(;)3(81511110"},{s:"111111.41(603<2<303<3.2(8(2*3(;)2)8)2.511110"}],bgImage={s:"111031/311+51111151+71-;+51-311+31(3(9)51+71,2111116111111111111+=1111.?11/=1+C1<1*@1(E=.=1(D.EA(<(?0E>*E>N>/IDN@IBG=-H=H?IBKE=H+HAJEEE=JEEEEEEEEE@",c:[c[8],c[9],c[6],c[7]],w:50},trees=[{s:")5111/<)411+4.>11/H.?)41,4H-4)<G=0=3-G*F-AGE0G*4.E>1=F1*4,?G>-H11,=L>N4+4+4<J=M-H+>->G?L1->*=OI10AG?L11?I=(=G<H1F1*@*<H<H.H5/5-<F<J,H11+<G<I(4=11-=F=I*I)411<G<N)J11=O*41)6-<N11>.<H=H11*>,<H=H115@)<H>G11,BF<F>G11*>(=G<F<F<I.41>,?F<F<I.H.5-4=F<K,H11*<N*G)H11<N)G-F10=OG-41/J=J11/<O110<F<M110<F<M11/=OF11-=K=J11+=J<G<G<H11)=J=G<G=H11=G=G<H=G<J.",c:[!1,c[24],c[16],c[19]],w:40},{s:"11)2=/A*?+4?+E?+5?+>2=FA+3F2A*@2F?,3F2B+AH7G3*@+>3<2I3G3->*=2?)H2G31*B*H4*?.@,2G3+>0?,2F4,=1>)>2G3,21->2G3+2112G5)2112G9<31>*2H2,=/E2H2+>02H=2=F2G2+>1)2K2G31*A8F2F21+>3=)4F2F21,<3=,2F2F21/>+611,2F411,2G411*2F2F2F211*2F2F411*2F2F411)5F2F211(3F2I31",c:[!1,c[16],c[24],c[19]],w:30},{s:"1(3.41)3*3*3+4*2.4<(<+3+=*3/3>*3+=)2(21*@+F3)3<1*<3,F3)<2<.2*3(=3*GA.3<(4=(4(<K)3+4=4<,=H)H3<*3*<)<3(>H*F+4+A3=I+3+3)4J3G<H3)4+2(4*=J<H4)31.G<H-204+3<H02,3?)4<F=)3=*3*5)M=)4>4/G,I+>12G,<F<G)=406+<I>*3/3.<F<G=+21/<F<G<11*=F<G11+<J11+<J11+G<F<F11*<I<F11)=I<F11)<M11<G<L1(",c:[!1,c[24],c[16],c[19]],w:30}],letters=["(5(2)2(2)8*3*2","(4(2*6(2*3*6(","(4(2*3+2+2*2(4(","(3)2)2(2*3*3*2(4(","(4(2+2+4)2+6","(6+2+4)2+2+","(4(2*3+2)4*2(4(","+3*3*8*3*2","(4*2+2+2+2*4(","(5+2+3*2(2(2*2)","(2)2(2)2(2(2(2(2)2)2(2*2","(2*2+2+2+2,5","(2)4(4(2(3(2(3*3*2","(2)4)3(2(3(2(3)4*2","(4(2*3*3*3*2(4(","(4(2*3*6(2+2+","","(4(2*3*6(2(2)2)3","(4(2,4,2+2(4(","(6(2+2+2+2+2)","+3*3*3*3*2(4(","+3*2(2(2)2(2*2+2)","+3*3(2(3(2(4(4*2","","(2)2(2)2)3*2)3*2+","",")2+2+2+202)","11.2)","1.2,2*2.","+2*2*2+2*2*20",")3)2)3*3*3)2)3.",")2*3+2+2+2*4(","(4(2*2*2*2*2*5-","(4(2*2*2*2(3*2(4(",")2*2+2(2(2)2(5+2(","(5(2+4,3*2(4-",")4(2+4(2*3*2(4-","(5+2+2*2*2+2)",")2*2(2)4(2*3*2(4-",")6)3)6(2+2(4-"];function unpackImage(e){let t=[];for(let a=0;a<e.length;a++)t.push({type:Math.floor((e.charCodeAt(a)-40)/10),add:e.charCodeAt(a)%10});let a=[];for(let e=0;e<t.length;e++){a.push(t[e].type);for(let n=0;n<t[e].add;n++)a.push(t[e].type)}return a}function unpackImgLoop(e){for(let t=0;t<e.length;t++)e[t].a=[],e[t].a=unpackImage(e[t].s)}function unpack3(e){for(let t=0;t<e.length;t++)unpackImgLoop(e[t]),e[t].push(e[t][1])}function unpackAll(){pushCol(jumpCol,jumpLoop),pushCol(sleepCol,sleepLoop),pushCol(stillCol,stillLoop),pushCol(babyCol,babyWalkLoop),pushCol(babyCol,babyCarriedLoop),pushCol(sunCol,sunLoop),unpackImgLoop(tigerWalkLoop),unpackImgLoop(walkLoop),unpackImgLoop(trees),unpack3([babyCarriedLoop,jumpLoop,stillLoop,sleepLoop,birdStillLoop,tigerJumpLoop,sunLoop]),unpackImgLoop(birdFlapLoop),birdFlapLoop.push(birdFlapLoop[2]),birdFlapLoop.push(birdFlapLoop[1]),unpackImgLoop(babyWalkLoop),babyWalkLoop.push(babyWalkLoop[2]),babyWalkLoop.push(babyWalkLoop[1]),groundImg.a=unpackImage(groundImg.s),bgImage.a=unpackImage(bgImage.s),homeImg.a=unpackImage(homeImg.s);for(let e=0;e<letters.length;e++)alphabet[e]={s:letters[e],c:[!1,c[1]],w:5};unpackImgLoop(alphabet)}function displayText(e,t,a,n,i,s,r){let o=0;for(let n=0;n<e.length;n++){let c=e.charCodeAt(n);c>=97&&c<=122?o=c-97:c>=48&&c<=57?o=c-48+30:46===c?o=27:44===c?o=28:33===c?o=26:32===c?o=-1:47===c&&(o=29);let l=t+n*(s+5),F=a;r&&(F=a+10*Math.sin(n/e.length+frame/30)),-1!=o&&displayImage(alphabet[o].a,[!1,i],l,F,5,s/5,1)}}var frameRate=30;let sunDownFrame=200*frameRate;var player,bgm,yShift=0,frame=0;let phase,gameLoop,startPos,ground=[],canvasH=570,canvasW=window.innerWidth,sunStart=.5*canvasH,sunPos={x:canvasW/4,y:sunStart},levelRange=0,currentLevel={},currentPhase=0,clickA={x:0,y:0,w:200,h:50},currentScreen="start",introSeq=0,introTxt=["they call you mama ape.","your three kiddos that is.","mama ape likes her naps. ","three times a day.","nothing less. "," ","everytime you wake,","you find your three rascals are gone","you cannot sleep again","until they are back home."," ","those baby apes","are helpless on their own","so you will have to haul them ","on your back,","knocking back the junglefolk","that block your way."," ","in short","by sundown, everyone must be back home","and you must have thrice napped"," ","click to wake up!"],currentText=introTxt,trace=0,traceSpeed=.1,babies=[],baddies=[],baddieLocations=[],baddiesOnScreen=0,babiesReturned=0,inputLeft=!1,inputRight=!1,stopSpeed=.4,chirping=!1,level=0,naps=0,thankYouText="",timeLeft=0,alphabet=[],particles=[],gameOver=!1;var canvas={canvas:document.createElement("canvas"),start:function(){this.canvas.width=canvasW,this.canvas.height=canvasH,this.context=this.canvas.getContext("2d"),document.body.insertBefore(this.canvas,document.body.childNodes[0])},clear:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}};function preload(){unpackAll(),canvas.start(),clickA.x=canvasW/2-clickA.w/2,clickA.y=canvasH/2+50,gameLoop=setInterval(function(){displayStartScreen(),trace+=traceSpeed,frame++},1e3/frameRate)}function displayStartScreen(){let e=frame%100*2.5,t=165+60*Math.sin(frame/100);displayText("ape naps",canvasW/2-150,canvasH/2-50,0,"rgb("+e+","+t+",50)",35,!0),displayText("click to",clickA.x,clickA.y,0,"black",20,!1),displayText("start",clickA.x+40,clickA.y+25,0,"black",20,!1),ctx.beginPath(),ctx.strokeStyle="black",ctx.rect(clickA.x,clickA.y,clickA.w,clickA.h),ctx.stroke(),ctx.closePath()}function startGame(){clearInterval(gameLoop),gameLoop=setInterval(updateGameArea,1e3/frameRate),console.log("game started"),currentScreen="introscreen",frame=0,trace=0,setupLevel(currentLevel=level1),shootTextSequence(),setTimeout(function(){currentScreen="wakeplayer"},1e3*(currentText.length-1))}function shootTextSequence(){for(let e=0;e<currentText.length;e++)setTimeout(function(){introSeq<currentText.length&&introSeq++},1e3*e)}function updateGameArea(){if(canvas.clear(),player.sleeping||gameOver)if(gameOver)displayText(thankYouText,canvasW/4,canvasH/2,0,"black",canvasW/150,!0),displayText("game over. click to start again ",canvasW/4,canvasH/2+50,0,"black",canvasW/150,!0);else{triggerParticles(flRand(player.x,player.x+160),flRand(player.y-200,player.y-0),[{r:225,g:200,b:10},{r:225,g:20,b:10},{r:25,g:200,b:10},{r:25,g:20,b:210}]),introSeq<currentText.length&&displayText("click to skip",canvasW-160,canvasH-30,0,"black",5,!1),"introscreen"===currentScreen&&(bgImage.c[0]="rgb("+skyShades[6].r+","+skyShades[6].g+","+skyShades[6].b+")"),drawBG(),updateAll(particles),displayTree(trees[0],canvasW/2+100,150,8),displayTree(trees[1],canvasW/2-120,150,8),displayTree(trees[2],canvasW/2-280,100,8),player.update();for(let e=0;e<introSeq;e++)displayText(currentText[e],48,48+20*e,400,"black",10,!0),displayText(currentText[e],50,50+20*e,400,"gold",10,!0)}else currentScreen="game",thankYouText="",timeLeft=Math.floor((sunDownFrame-frame)/frameRate),chirping=!1,displayBackground(),updateAll(particles),displayGround(),displayAll(ground),displayReturnPoint(),player.update(),updateAll(baddies),updateAll(babies),displayText("sundown in "+timeLeft.toString(),20,25,0,"white",25,!1),displayText("naps "+naps,canvasW-160,19,0,"white",19,!1),displayText("babies returned "+babiesReturned,canvasW-425,45,0,"white",19,!1),continueLevel();runBGM(),trace+=traceSpeed,frame++}function displayReturnPoint(){let e=canvasW/2-(player.x-startPos.x),t=startPos.y-yShift-80;displayImage(homeImg.a,homeImg.c,e,t,25,4,1),displayText("home",e+25,t-20,0,c[23],8,!0)}function posOnScreen(e){return{x:canvasW/2-(player.x-e.x),y:e.y-yShift}}function inRange(e,t,a){return e<t+a&&e>t-a}function inSegment(e,t,a,n){return e+t/2-8>a&&e-t/2+8<a+n}function inBox(e,t,a,n,i,s){return e>=a&&e<=a+i&&t>=n&&t<=n+s}function collideRectRect(e,t,a,n,i,s,r,o){return e+a>=i&&e<=i+r&&t+n>=s&&t<=s+o}function displayAll(e){for(let t=0;t<e.length;t++)e[t].display()}function updateAll(e){for(let t=0;t<e.length;t++)e[t].update()}function randI(e){return Math.floor(Math.random()*e)}function flRand(e,t){return Math.floor(e+Math.random()*(t-e))}function constrain(e,t,a){return Math.min(Math.max(e,t),a)}function pushCol(e,t){for(let a=0;a<t.length;a++)t[a].c=e}function updateAngle(e,t,a,n,i,s){return constrain(e+s*Math.sin(frame/t)*a,n,i)}function addLine(e,t,a,n){ctx.moveTo(e,t),ctx.lineTo(a,n)}function distToGround(e,t,a){let n=canvasH;for(let i=0;i<ground.length;i++)inSegment(e,a,ground[i].x,ground[i].w)&&ground[i].y>t&&ground[i].y<n&&(n=ground[i].y);return n-t}function getXYOnPlat(e,t){let a,n;return-1===e.p?(a=e.x,n=canvasH):(a=10*t[e.p].x+e.x,n=canvasH-10*t[e.p].y-10),{x:a,y:n}}function keyReleased(){console.log("key release "+event.keyCode),65===event.keyCode?inputLeft=!1:68===event.keyCode&&(inputRight=!1)}function keyPressed(){switch(console.log("key pressed! code: "+event.keyCode),event.keyCode){case 97:moveX(-1),console.log("left");break;case 100:moveX(1);break;case 32:player.sleeping||player.startJump(player)}}function mousePressed(){console.log(event.clientX),"start"===currentScreen?(inBox(event.clientX,event.clientY,clickA.x,clickA.y,clickA.w,clickA.h)&&startGame(),startSound()):"gameover"===currentScreen?(Object.assign(currentLevel,level1),currentText=introTxt,level=0,currentScreen="wakeplayer",introSeq=0,naps=0,currentPhase=0,player.sleeping=!1,gameOver=!1,trace=0,setupLevel(currentLevel)):"wakeplayer"!==currentScreen&&"introscreen"!==currentScreen||(console.log("yo"),player.sleeping&&0===naps&&(frame=0),introSeq<currentText.length?introSeq=currentText.length:(player.sleeping=!1,trace=0))}function triggerParticles(e,t,a){let n=4+randI(5);for(let i=0;i<n;i++){let n=flRand(0,a.length);particles.push(new Particle(e,t,particles.length,a[n]))}}class Particle{constructor(e,t,a,n){this.x=e-player.w/2,this.y=t-player.h/2,this.speed=flRand(2,4),this.dir=2*Math.random()*Math.PI,this.vel={x:this.speed*Math.cos(this.dir),y:this.speed*Math.sin(this.dir)},this.opa=.8,this.r=n.r,this.g=n.g,this.b=n.b}update(){this.x+=this.vel.x,this.y+=this.vel.y,this.opa-=this.speed/150,ctx=canvas.context,ctx.beginPath(),ctx.globalAlpha=this.opa,ctx.fillStyle="rgba("+this.r+","+this.g+","+this.b+")";let e=posOnScreen(this);ctx.fillRect(e.x,e.y,8,8),ctx.stroke(),ctx.globalAlpha=1,ctx.closePath(),this.opa<=0&&killParticle(this.index)}}function killParticle(e){particles.splice(e,1)}let organ=[{f:499.98,a:.05024,p:-79.26},{f:989.78,a:.01608,p:10.89},{f:1489.66,a:.02179,p:-13.22},{f:1989.55,a:.03411,p:-30.97},{f:2489.44,a:.01904,p:156.26},{f:2989.32,a:.03099,p:-54.57},{f:3469.21,a:.00796,p:-49.46},{f:3979.1,a:.01728,p:-129.91}],lengthOf8=7,time=0;var context;let buffers=[];function startSound(){window.AudioContext=window.AudioContext||window.webkitAudioContext,context=new AudioContext}var voices=[{notes:"UPNPQPNPIIUPNPQPNPNLNLNPNLNLKLKLNLNPNLPNLKLNLKLILKNLKIPLKIPLKINLKINKIGNKIGNKIGLKIGLIGFLIGFLIGFKIGFKGFGIGFGFDFGIKFGIFGIGFIGDGKGKPKPSPSUSRPRPOWRPOWSRPWSRPWOMKWNLKNPRKOP",durations:"**))*))*****))*))*))*))*))*))*))*))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))*))*))))))))))))))))))))))))))))))))))))))))))))))))))))))****.",nextTrigger:0,noteCounter:0},{notes:"=?@=@=B=B=@=B=@=?=@=@=B=B=@=@=?=?=<?:?<?8?=8=8?8?8@8=8?8<8=848148;:=6:/36:8;48.1487:378383737383,383837373838;8;?DC?C?D?8;=;=:;=?3DEDB@?",durations:"))))))))))))))))))))))))))))))))))))))))))))))))))))))))))****************************))))))))****))))))))************************))))))",nextTrigger:0,noteCounter:0}];function runBGM(){playVoice(1,organWaveAt,.25,10,.19,.5),playVoice(0,organWaveAt,.25,40+frame%3e3,.45,.3),playDrum(),time++}function playDrum(){let e,t=Math.random();if(checkTime(2)?e=chanceToPlay(t,1,7,2,1):checkTime(1)?e=chanceToPlay(t,.4,3,2,1):checkTime(.5)&&(e=chanceToPlay(t,.4,0,2,8)),null!=e){let t=e.base+Math.random()*e.vari;loadAndPlay(noiseAt,5,.45,e.vol,t,!0)}}function checkTime(e){return time%(lengthOf8*e)==0}function chanceToPlay(e,t,a,n,i){if(e<t){let t=a+n+i;return e<a/t?{base:20,vari:5,vol:.04}:e<(a+n)/t?{base:4e3,vari:1e3,vol:.04}:{base:1e4,vari:1e3,vol:.01}}}function playVoice(e,t,a,n,i,s){let r=voices[e];if(time===r.nextTrigger){let o=r.noteCounter,c=r.durations.charCodeAt(o)-40;loadAndPlay(t,n,c*i,s,Math.pow(2,(r.notes.charCodeAt(o)-64)/12)*a,!1),voices[e].nextTrigger=time+c*lengthOf8,voices[e].noteCounter++,r.noteCounter>=r.notes.length&&(voices[e].noteCounter=0)}}function loadAndPlay(e,t,a,n,i,s){let r,o=[];0!=t&&(r=t);let c=0,l=context.sampleRate*a;for(var F=0;F<l;F++){let a=F/l;if(a>.7?c=constrain(c-3e-4,0,n):a<.1&&(c=constrain(c+.005,0,n)),o[F]=e(F,i)*c,F>=r&&F+10<l&&0!=t&&s)for(let e=0;e<4;e++)o[F-r+2*e]-=o[Math.round(F-r+2*e+1)];else F>=r&&F+10<l&&0!=t&&(o[F-r]+=o[F])}playSound(o)}function loadSlidingSound(e,t,a,n,i,s){let r,o=[],c=context.sampleRate*a,l=0,F=.01*a;0!=t&&(r=t);for(var d=0;d<c;d++){let a=d/c,p=i+a*(s-i);a>.7?l=constrain(l-F,0,1):a<.1&&(l=constrain(l+F,0,n)),o[d]=e(d,p)*l,d>=r&&0!=t&&(o[d-r]+=o[d])}playSound(o)}function playSound(e){for(var t=new Float32Array(e.length),a=0;a<e.length;a++)t[a]=e[a];var n=context.createBuffer(1,t.length,context.sampleRate);n.copyToChannel(t,0);var i=context.createBufferSource();i.buffer=n,i.connect(context.destination),i.start(0)}function sineWaveAt(e,t){let a=context.sampleRate/t;return Math.sin(e/(a/(2*Math.PI)))}function noiseAt(e,t){context.sampleRate;let a=constrain(Math.pow(e,2)/15e6,.1,.9),n=constrain(6-t/4e3,0,2e4);return e%2==0?0:(4*Math.random()-2+n*roundedSineWaveAt(e,t))*(1-a)}function roundedSineWaveAt(e,t){let a=context.sampleRate/t;return Math.round(Math.sin(e/(a/(2*Math.PI))))}function organWaveAt(e,t){let a=e/context.sampleRate,n=0;for(let e=0;e<organ.length;e++)n+=organ[e].a*Math.cos(2*Math.PI*t*organ[e].f*a+organ[e].p);return n}function monkeyCrySFX(){sfxSeq(5,2.2+.2*Math.random(),-.02,.08,-.01,50,0,organWaveAt,!1,.5)}function collideSFX(){sfxSeq(3,100,-30,.05,.09,5,10,roundedSineWaveAt,6,.1)}function thumpSFX(){sfxSeq(2,200,-100,.05,.09,5,10,roundedSineWaveAt,6,.1)}function jumpSFX(e,t,a){loadSlidingSound(organWaveAt,7,a,1,e,t)}function birdChirpSFX(e){e.onScreen&&(loadSlidingSound(sineWaveAt,100,.1,.1,1400+400*Math.random(),2650),chirping||setTimeout(function(){loadSlidingSound(sineWaveAt,100,.25,.06,1400+400*Math.random(),2700+800*Math.random())},150),chirping=!0)}function sfxSeq(e,t,a,n,i,s,r,o,c,l){for(let F=0;F<e;F++){let e=t+a*F,d=n+i*F;setTimeout(function(){loadAndPlay(o,c,d,l,e,!1)},F*(s+F*r))}}function newBaby(e,t){babies.push(new movingObject(e,t,20,20,displayBaby,updateBaby,babies.length)),babies[babies.length-1].isExploring=!1,babies[babies.length-1].isCarried=!1,babies[babies.length-1].grabbable=!0}function updateBaby(){this.isCarried?(this.x=player.x+20+player.dir*this.index*10,this.y=player.y-55+5*this.index,collideRectRect(canvasW/2-(player.x-startPos.x),startPos.y-yShift,startPos.w,startPos.h,canvasW/2,player.y-yShift,player.w,player.h)&&player.babiesCarried>0&&(player.babiesCarried--,this.isCarried=!1,this.grabbable=!1,this.returned=!0,this.isExploring=!1,this.x=startPos.x+startPos.w/2-15*this.index,this.y=startPos.y-20,babiesReturned++)):(this.isExploring?this.speedX=constrain(this.speedX+-1+2*Math.random(),-2,2):this.speedX=0,collideRectRect(canvasW/2-(player.x-this.x),this.y-yShift-this.h,this.w,this.h,canvasW/2,player.y-yShift-player.h,player.w,player.h)&&!player.knockedBack&&this.grabbable&&player.babiesCarried<2&&(this.isCarried||monkeyCrySFX(),this.isCarried=!0,player.babiesCarried++))}function displayBaby(){ctx=canvas.context,ctx.translate(0,-10);let e=posOnScreen(this),t=babyWalkLoop;this.isCarried&&(t=babyCarriedLoop),displayStringLoop(t,e.x,e.y-this.h,15,2,this.dir),ctx.translate(0,10)}class movingObject{constructor(e,t,a,n,i,s,r){this.speedX=0,this.x=e,this.y=t,this.w=a,this.h=n,this.jumping=!1,this.fallSpeed=0,this.display=i,this.updateMotion=s,this.counter=0,this.index=r,this.isCarried=!1,this.dir=1,this.init={x:e,y:t},this.flying=0===t}update(){this.onScreen=!1,inBox(canvasW/2-(player.x-this.x),this.y-yShift,0,0,canvasW,canvasH)&&(this.onScreen=!0),this.newPos(),this.updateMotion(),this.display()}getDir(){0!=this.speedX&&(this.dir=-this.speedX/Math.abs(this.speedX))}newPos(){this.knockedBack&&this.calculateKnockBack(),this.x=constrain(this.x+this.speedX,0,levelRange),this.y=constrain(this.y,-5e3,canvasH),this.jumping?this.calculateJump():this.flying||this.isCarried||this.calculateFall()}startJump(e){!this.jumping&&distToGround(this.x+this.w/2,this.y,this.w)<2&&("player"===this.index?jumpSFX(.5,1,.35):this.onScreen&&jumpSFX(.8,1.2,.1),this.jumping=!0,this.jumpForce=20)}forceJump(e){jumpSFX(.8,1.2,.1),this.jumping=!0,this.jumpForce=e}calculateJump(){this.jumpForce-=2,this.y-=this.jumpForce,this.jumpForce<=0&&(this.jumping=!1)}calculateFall(){let e=distToGround(this.x+this.w/2,this.y,this.w);e>this.fallSpeed||!1===this.grabbable&&this.y<canvasH&&Math.random()>.5&&1!=this.returned?(this.y+=this.fallSpeed,this.fallSpeed+=1,this.falling=!0):e>0&&(!0===this.falling&&this.fallSpeed>1&&this.onScreen&&thumpSFX(),this.falling=!1,this.fallSpeed=0,this.y+=e-1)}calculateKnockBack(){let e=Math.floor(this.speedX);e>0?this.speedX--:e<0?this.speedX++:this.knockedBack=!1}collided(e){this.knockedBack=!0,this.speedX=10*e,this.jumpForce=0,this.flying=!1}moveInBounds(e){this.knockedBack||1==this.stunned||(this.x<=this.leftBoundX?this.speedX=e:this.x>=this.rightBoundX?this.speedX=-e:0===this.speedX&&(Math.random()>.5?this.speedX=1:this.speedX=-1))}}function displayDudeBox(){ctx=canvas.context;let e=canvasW/2,t=-this.h;"wakeplayer"===currentScreen&&(t-=150),ctx.translate(0,t);let a=.5*canvasH;yShift=this.y>a?0:this.y-a,this.getDir();let n=3,i=walkLoop;this.sleeping?(i=sleepLoop,n=4):distToGround(this.x+this.w/2,this.y,this.w)>2?i=jumpLoop:0===this.speedX&&(i=stillLoop),displayStringLoop(i,e,this.y-yShift,25,n,this.dir),ctx.translate(0,-t)}function updatePlayerMotion(){this.knockedBack||this.sleeping?this.sleeping&&(this.speedX=0):(inputLeft||inputRight?inputRight?player.speedX+=.5:inputLeft&&(player.speedX-=.5):player.speedX+stopSpeed<0?player.speedX+=stopSpeed:player.speedX-stopSpeed>0?player.speedX-=stopSpeed:player.speedX=0,player.speedX=constrain(player.speedX,-10,10))}function moveX(e){e>0?inputRight=!0:inputLeft=!0}function newBaddie(e,t,a,n){baddies.push(new movingObject(e,t,n.w,n.h,n.d,n.u,baddies.length));let i=baddies.length-1,s=baddies[i];s.leftBoundX=s.x-a,s.rightBoundX=s.x+a,s.stunTimer,s.stunned=!1}function checkPlayerCollision(e){let t=baddies[e],a=player;if(collideRectRect(canvasW/2-(a.x-t.x),t.y-yShift-t.h,t.w,t.h,canvasW/2,a.y-yShift-a.h,a.w,a.h)&&!a.knockedBack){let n=!1,i=0,s=!1,r=!1,o=.8;if(distToGround(a.x+a.w/2,a.y,a.w)>5){if(t.y-20>a.y)s=!0;else{if(!(t.y-t.h<a.y))return;r=!0}o=1.5,t.stunned=!0;let n=e;clearTimeout(t.stunTimer),t.stunTimer=setTimeout(function(){baddies[n].stunned=!1},1e3)}for(let e=0;e<babies.length;e++)!babies[e].isCarried||n||s||(babies[e].isCarried=!1,babies[e].isExploring=!0,n=!0,i=e,a.babiesCarried--,babies[i].grabbable=!1);n&&setTimeout(function(){babies[i].grabbable=!0},500);let c=15;t.x<a.x?sendEmFlying(e,o,c,s,r,n,i,-1):sendEmFlying(e,o,c,s,r,n,i,1)}}function sendEmFlying(e,t,a,n,i,s,r,o){let c=player;n?(c.forceJump(a),baddies[e].collided(o*t),console.log("over!")):i?(console.log("under!"),player.collided(-o),baddies[e].forceJump(1.5*a)):(console.log("neither!"),c.collided(o),baddies[e].collided(-o*t)),s&&babies[r].collided(3*o),triggerParticles(c.x+c.w/2,c.y+c.h/2,[{r:255,g:125,b:125}]),collideSFX()}function displayFlyingBaddie(){let e=-this.h;ctx.translate(0,e);let t=posOnScreen(this);this.getDir();let a=birdStillLoop;this.flying&&(a=birdFlapLoop),displayStringLoop(a,t.x,t.y,20,2,this.dir),ctx.translate(0,-e),this.counter++}function updateFlyingBaddie(){checkPlayerCollision(this.index),this.flying?this.y>this.init.y-50?this.y--:(this.y=constrain(this.y+-1+2*Math.random(),this.init.y-100,canvasH),this.counter%450==0&&(this.flying=!1,birdChirpSFX(this))):this.counter%150==0&&(this.flying=!0,birdChirpSFX(this)),this.moveInBounds(2)}function displayJumpingBaddie(){let e=-this.h;ctx.translate(0,e);let t=posOnScreen(this);this.getDir();let a=tigerWalkLoop;distToGround(this.x+this.w/2,this.y,this.w)>2&&(a=tigerJumpLoop),displayStringLoop(a,t.x,t.y-40.5,27,3,this.dir),ctx.translate(0,-e),this.counter++}function updateJumpingBaddie(){checkPlayerCollision(this.index),this.counter%150==0&&this.startJump(baddies[this.index]),this.moveInBounds(2)}class groundTile{constructor(e,t,a){this.x=e,this.y=t,this.w=a,this.hasCos=!1}display(){if(inRange(this.x,player.x,canvasW/2)||inRange(this.x+this.w,player.x,canvasW/2)){let e=canvasW/2-(player.x-this.x);for(let t=0;t<this.w/20;t++)displayImage(groundImg.a,groundImg.c,e+20*t,this.y-yShift-4,5,4,1);if(0!=this.hasCos){let t=trees[this.hasCos.t],a=3;displayTree(t,e+this.hasCos.x,this.y-yShift-t.w*a,a)}}}}function displayTree(e,t,a,n){displayImage(e.a,e.c,t,a,e.w,n,1)}function continueLevel(){babiesReturned>=babies.length&&nextPhase(),timeLeft<=0&&gameIsOver()}function gameIsOver(){gameOver=!0,currentScreen="gameover"}function nextPhase(){if(napping=!0,babiesReturned=!0,player.sleeping=!0,trace=0,3===++naps){switch(currentText=["the day is over. level complete!","click to continue"],setTimeout(function(){currentScreen="wakeplayer"},1e3),shootTextSequence(),introSeq=0,++level){case 1:currentLevel=level2;break;case 2:thankYouText="congrats! you've reached the end. thank you for playing.\n",gameIsOver()}naps=0,setupLevel(currentLevel)}else{switch(currentText=["good job mama ape!","time for a nap."],currentScreen="wakeplayer",shootTextSequence(),introSeq=0,traceSpeed=10,currentPhase++,setTimeout(function(){player.sleeping=!1,traceSpeed=.1},5e3),phase=JSON.parse(JSON.stringify(currentLevel)),level){case 0:currentPhase>=1&&(phase.baddies.push({p:20,x:30,r:300,kit:fB}),phase.baddies.push({p:6,x:10,r:40,kit:jB}),phase.baddies.push({p:-1,x:550,r:345,kit:jB}),2===currentPhase&&(phase.baddies.push({p:1,x:0,r:245,kit:fB}),phase.baddies.push({p:10,x:250,r:245,kit:fB}),phase.baddies.push({p:10,x:250,r:245,kit:jB})));break;case 1:currentPhase>=1&&(phase.baddies.push({p:-1,x:1500,r:200,kit:jB}),phase.baddies.push({p:3,x:30,r:100,kit:fB}),phase.baddies.push({p:11,x:30,r:100,kit:fB}),phase.baddies.push({p:16,x:0,r:250,kit:fB}),phase.baddies.push({p:6,x:30,r:100,kit:fB}),2===currentPhase&&(phase.baddies.push({p:-1,x:1050,r:500,kit:fB}),phase.baddies.push({p:-1,x:1650,r:500,kit:fB}),phase.baddies.push({p:12,x:0,r:100,kit:fB}),phase.baddies.push({p:10,x:0,r:300,kit:fB})))}setupLevel(phase)}}let jB={t:"jump",w:81,h:40.5},fB={t:"fly",w:40,h:40},level1={size:1300,cosmetics:[0,2,4,6,8,14,18],plat:[{x:30,y:75,w:30},{x:65,y:67,w:5},{x:45,y:60,w:10},{x:38,y:58,w:5},{x:30,y:52,w:10},{x:31,y:46,w:3},{x:80,y:60,w:10},{x:92,y:58,w:5},{x:100,y:52,w:10},{x:102,y:46,w:3},{x:32,y:40,w:73},{x:55,y:35,w:5},{x:75,y:35,w:5},{x:65,y:28,w:5},{x:40,y:25,w:8},{x:32,y:18,w:5},{x:38,y:12,w:5},{x:32,y:6,w:5},{x:88,y:25,w:8},{x:95,y:18,w:5},{x:89,y:12,w:5},{x:95,y:6,w:5},{x:66,y:46,w:3}],baddies:[{p:10,x:365,r:325,kit:jB},{p:10,x:480,r:245,kit:fB},{p:16,x:30,r:300,kit:fB},{p:-1,x:500,r:450,kit:jB},{p:2,x:10,r:40,kit:jB},{p:14,x:-5,r:245,kit:fB}],player:{p:0,x:30},babies:{count:3,pos:[15,-1,21,5],p:0,x:0}},level2={size:2500,cosmetics:[2,5,10,8,12,13,14,17,18,20,21],plat:[{x:0,y:5,w:5},{x:0,y:10,w:5},{x:0,y:15,w:15},{x:30,y:8,w:10},{x:40,y:14,w:10},{x:50,y:20,w:25},{x:90,y:8,w:10},{x:100,y:14,w:10},{x:90,y:21,w:10},{x:100,y:28,w:10},{x:110,y:35,w:25},{x:150,y:7,w:10},{x:160,y:14,w:10},{x:170,y:20,w:25},{x:195,y:27,w:25},{x:190,y:35,w:5},{x:185,y:42,w:5},{x:180,y:49,w:5},{x:170,y:56,w:10},{x:220,y:35,w:5},{x:225,y:42,w:5},{x:230,y:49,w:5},{x:235,y:49,w:10}],baddies:[{p:7,x:30,r:100,kit:fB},{p:21,x:-100,r:250,kit:fB},{p:4,x:-50,r:100,kit:fB},{p:5,x:80,r:70,kit:jB},{p:10,x:80,r:70,kit:jB},{p:13,x:80,r:70,kit:jB},{p:14,x:80,r:70,kit:jB},{p:-1,x:500,r:200,kit:jB},{p:-1,x:1e3,r:200,kit:jB},{p:-1,x:2e3,r:200,kit:jB},{p:-1,x:1700,r:800,kit:fB}],player:{p:2,x:10},babies:{count:3,pos:[5,10,13,14,18,22],p:0,x:0}};function setupLevel(e){levelRange=e.size,ground=[],baddies=[],babies=[],currentPhase=0,sunPos={x:canvasW/4,y:sunStart};for(let t=0;t<e.plat.length;t++)if(ground.push(new groundTile(10*e.plat[t].x,canvasH-10*e.plat[t].y,10*e.plat[t].w)),e.cosmetics.includes(t)){let a=randI(3);ground[ground.length-1].hasCos={x:2*e.plat[t].w,t:a}}for(let t=0;t<e.baddies.length;t++){let a=getXYOnPlat(e.baddies[t],e.plat),n=e.baddies[t].kit;"jump"===n.t?(n.d=displayJumpingBaddie,n.u=updateJumpingBaddie):(n.d=displayFlyingBaddie,n.u=updateFlyingBaddie),newBaddie(a.x,a.y,e.baddies[t].r,e.baddies[t].kit)}for(let t=0;t<e.size/150;t++){let e=randI(3);ground.push(new groundTile(150*t+flRand(0,50),canvasH,10)),ground[ground.length-1].hasCos={x:0,t:e}}let t=getXYOnPlat(e.player,e.plat);(player=new movingObject(t.x,t.y,75,75,displayDudeBox,updatePlayerMotion,"player")).sleeping=!0,player.babiesCarried=0,startPos={x:t.x,y:t.y,w:80,h:80},babiesReturned=0;for(let t=0;t<e.babies.count;t++){e.babies.p=e.babies.pos[randI(e.babies.pos.length)];let a=getXYOnPlat(e.babies,e.plat);newBaby(a.x+10*t,a.y)}}let skyShades=[{r:133,g:186,b:214,t:0},{r:17,g:128,b:214,t:.6},{r:101,g:155,b:184,t:.7},{r:236,g:236,b:29,t:.8},{r:255,g:59,b:59,t:.9},{r:51,g:70,b:95,t:.96},{r:51,g:70,b:95,t:1}],sunShades=[{r:255,g:235,b:215,t:0},{r:255,g:255,b:15,t:.5},{r:255,g:255,b:15,t:.7},{r:255,g:55,b:55,t:.8},{r:255,g:35,b:185,t:1}];function fadeLight(e){let t,a,n,i=frame/sunDownFrame;for(let s=0;s<e.length;s++)if(i<e[s].t){let i=(frame-e[s-1].t*sunDownFrame)/((e[s].t-e[s-1].t)*sunDownFrame);return{r:t=e[s-1].r+i*(e[s].r-e[s-1].r),g:a=e[s-1].g+i*(e[s].g-e[s-1].g),b:n=e[s-1].b+i*(e[s].b-e[s-1].b)}}}function displayBackground(){let e=fadeLight(skyShades);bgImage.c[0]="rgb("+e.r+","+e.g+","+e.b+")",drawBG(),drawSun()}function drawSun(){let e=fadeLight(sunShades);for(let t=0;t<sunLoop.length;t++)sunLoop[t].c[1]="rgb("+e.r+","+e.g+","+e.b+")";let t=1;frame/sunDownFrame<.5&&(t=-1),sunPos.y+=t*(canvasH/sunDownFrame),sunPos.x+=canvasW/2/sunDownFrame,displayStringLoop(sunLoop,sunPos.x-player.x/4,sunPos.y-yShift/2,8,8,1)}function drawBG(){displayImage(bgImage.a,bgImage.c,-player.x/4,-.4*canvasH-yShift/2,bgImage.w,1.5*canvasW/bgImage.w,1)}function displayGround(){player.x,this.x;for(let e=0;e<canvasW/20;e++)displayImage(groundImg.a,groundImg.c,20*e-player.x%20,canvasH-yShift-4,5,4,1)}

</script><style>canvas{ border:1px solid #d3d3d3; background-color: #f1f1f1;}</style></head>
<body onload="preload()" onkeypress="keyPressed()" onkeyup="keyReleased()" onclick="mousePressed()">
</body></html>
